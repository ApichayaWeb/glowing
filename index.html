<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ระบบตรวจสอบย้อนกลับผักอุดร</title>
  <meta name="description" content="ระบบตรวจสอบย้อนกลับผักอุดร จ.อุดรธานี" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      /* สดใสขึ้น */
      --bg:#f5fff7;            /* page bg */
      --card:#ffffff;          /* card bg */
      --muted:#57756b;         /* muted text */
      --text:#0e2b1f;          /* main text */
      --brand:#198754;         /* primary */
      --brand-2:#146c43;       /* primary darker */
      --accent:#ff8a3d;        /* accent */
      --ring: rgba(25,135,84,.35);
      --shadow: 0 10px 30px rgba(22, 87, 62, .12);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:"Noto Sans Thai", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:
        radial-gradient(900px 500px at 85% -10%, rgba(255,186,120,.22), transparent),
        radial-gradient(800px 500px at -10% 10%, rgba(25,135,84,.18), transparent),
        var(--bg);
      color:var(--text);
      line-height:1.6;
    }
    a{color:inherit;text-decoration:none}
    .container{width:min(1120px, 92vw); margin-inline:auto}

    /* NAVBAR */
    .nav{
      position:sticky; top:0; z-index:50;
      backdrop-filter:saturate(160%) blur(8px);
      background:rgba(255,255,255,.85);
      border-bottom:1px solid rgba(14,43,31,.08);
    }
    .nav-inner{display:flex;align-items:center;gap:16px; padding:14px 0}
    .brand{display:flex;align-items:center;gap:12px; font-weight:800; letter-spacing:.2px; color:#0a3c2a}
    .brand .logo{width:36px;height:36px;display:grid;place-items:center;border-radius:10px;
      background:conic-gradient(from 210deg at 50% 50%, #28a745 0 40%, #198754 40% 70%, #ffd166 70% 100%);
      box-shadow:inset 0 0 0 4px rgba(0,0,0,.03), 0 6px 18px rgba(25,135,84,.25);
    }
    .spacer{flex:1}
    .nav a.link{opacity:.85; transition:.2s; padding:.5rem .75rem; border-radius:10px}
    .nav a.link:hover{opacity:1; background:rgba(25,135,84,.08)}

    /* BUTTONS */
    .btn{display:inline-flex; align-items:center; gap:8px; padding:.65rem 1rem; border-radius:12px;
      background:linear-gradient(180deg, var(--brand), var(--brand-2)); box-shadow:0 10px 18px rgba(25,135,84,.25);
      color:#fff; font-weight:800}
    .btn:hover{filter:brightness(1.03)}
    .btn-outline{display:inline-flex; align-items:center; gap:8px; padding:.55rem .95rem; border-radius:12px;
      border:2px solid var(--brand); color:var(--brand); font-weight:800; background:transparent}
    .btn-outline:hover{background:rgba(25,135,84,.08)}

    /* HERO */
    .hero{padding:88px 0 56px; position:relative}
    .hero-grid{display:grid; grid-template-columns:1.2fr .8fr; gap:24px}
    .hero .panel{background:linear-gradient(180deg, rgba(25,135,84,.12), rgba(255,255,255,.7));
      border:1px solid rgba(14,43,31,.08); border-radius:var(--radius); padding:28px; box-shadow:var(--shadow)}
    .eyebrow{color:var(--accent); font-weight:900; letter-spacing:.3px; text-transform:uppercase; font-size:.85rem}
    h1{margin:.3rem 0 1rem; line-height:1.12; font-weight:900; font-size:clamp(1.9rem, 3.2vw + 1rem, 3rem)}
    .hero p{color:#35594b; font-size:1.05rem}
    .hero-cta{display:flex; gap:12px; margin-top:18px; flex-wrap:wrap}
    .stat{display:flex; gap:16px; align-items:center; margin-top:10px}
    .stat .pill{padding:.45rem .75rem; border:1px dashed rgba(14,43,31,.18); border-radius:999px; font-size:.9rem; color:#2c5245; background:rgba(25,135,84,.08)}

    /* SECTIONS */
    section{padding:56px 0}
    h2{font-size:clamp(1.4rem, 2.2vw + .6rem, 2rem); margin:0 0 12px}
    p.lead{color:var(--muted)}
    /* GALLERY */
    .gallery{display:grid; grid-template-columns:repeat(12, 1fr); gap:14px}
    .tile{grid-column: span 4; border-radius:16px; overflow:hidden; position:relative; isolation:isolate; min-height:160px;
      background:linear-gradient(135deg, rgba(25,135,84,.14), rgba(255,255,255,.6)); border:1px solid rgba(14,43,31,.08)}
    .tile.large{grid-column: span 8; min-height:220px}
    .tile img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; filter:saturate(1.06)}
    .tile .label{position:absolute; bottom:8px; left:8px; background:rgba(255,255,255,.88); padding:.4rem .65rem; border-radius:8px; font-weight:800; color:#134433}

    /* DRIVE EMBED */
    .drive-embed iframe{width:100%; height:560px; background:#fff; border:1px solid rgba(14,43,31,.12); border-radius:18px; box-shadow:var(--shadow)}
    @media (max-width: 640px){
      .drive-embed iframe{height:420px}
    }

    /* NICE GALLERY CARD */
    .gallery-card{background:#fff; border:1px solid rgba(14,43,31,.12); border-radius:24px; box-shadow:var(--shadow); overflow:hidden}
    .gallery-toolbar{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:18px; border-bottom:1px solid rgba(14,43,31,.08); background:linear-gradient(90deg, rgba(25,135,84,.08), rgba(255,209,102,.10))}
    .gallery-toolbar h2{margin:0}
    .toolbar-actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .chip{display:inline-flex; align-items:center; gap:8px; padding:.5rem .85rem; border-radius:999px; border:1.5px solid rgba(14,43,31,.12); background:#fff; color:var(--text); font-weight:700; cursor:pointer}
    .chip.active{border-color:var(--brand); box-shadow:0 0 0 4px rgba(25,135,84,.12); color:#0e2b1f}
    .chip.sm{padding:.35rem .65rem; font-weight:700; font-size:.9rem}
    .view-toggle{display:flex; gap:8px; align-items:center}
    .view-toggle.hide{display:none}
    .tab-panel{padding:16px}
    .masonry{columns: 1; column-gap:14px}
    @media (min-width: 640px){ .masonry{columns:2} }
    @media (min-width: 980px){ .masonry{columns:3} }
    .card-item{break-inside: avoid; margin-bottom:14px}
    .thumb{display:block; border-radius:16px; overflow:hidden; position:relative; border:1px solid rgba(14,43,31,.12); background:#f7fff9}
    .thumb img{width:100%; height:auto; display:block; transition: transform .35s ease, filter .35s ease}
    .thumb:hover img{transform:scale(1.04)}
    .thumb .cap{position:absolute; left:10px; bottom:10px; background:rgba(255,255,255,.9); border-radius:10px; padding:.35rem .6rem; font-weight:800; color:#134433; box-shadow:0 4px 10px rgba(0,0,0,.08)}
    .lightbox{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.75); padding:24px; z-index:60}
    .lightbox[aria-hidden="false"]{display:grid}
    .lightbox img{max-width:min(95vw, 1200px); max-height:86vh; border-radius:18px; box-shadow:0 20px 50px rgba(0,0,0,.5)}
    .lightbox .close{position:absolute; top:20px; right:20px; border:0; border-radius:12px; padding:.5rem .7rem; font-size:20px; font-weight:900; background:#fff; color:#0e2b1f; cursor:pointer}

    /* DRIVE EMBED */
    .drive-embed iframe{width:100%; height:560px; background:#fff; border:1px solid rgba(14,43,31,.12); border-radius:18px; box-shadow:var(--shadow)}
    @media (max-width: 640px){
      .drive-embed iframe{height:420px}
    }

    /* HERO MEDIA (Drive) */
    .hero-media{position:relative; width:100%; aspect-ratio:16/11; border-radius:16px; overflow:hidden; border:1px solid rgba(14,43,31,.12); background:linear-gradient(135deg, rgba(25,135,84,.08), rgba(255,255,255,.9)); box-shadow:var(--shadow)}
    .hero-media img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block}

    /* VIDEO */
    .video-wrap{display:grid; grid-template-columns:1.2fr .8fr; gap:18px; align-items:start}
    .video-frame{background:#fff; border:1px solid rgba(14,43,31,.12); border-radius:18px; overflow:hidden; box-shadow:var(--shadow)}
    .video-frame .aspect{position:relative; padding-top:56.25%}
    .video-frame iframe, .video-frame video{position:absolute; inset:0; width:100%; height:100%; border:0}

    /* FOOTER */
    footer{padding:40px 0; color:#335b4c}
    footer .foot{display:flex; gap:18px; justify-content:space-between; align-items:center; border-top:1px solid rgba(14,43,31,.12); padding-top:18px}

    /* RESPONSIVE */
    @media (max-width: 980px){
      .hero-grid, .video-wrap{grid-template-columns:1fr;}
      .tile{grid-column: span 6}
      .tile.large{grid-column: span 12}
    }
    @media (max-width: 640px){
      .tile{grid-column: span 12}
    }
      
    /* INFO */
    .info-card{background:#fff; border:1px solid rgba(14,43,31,.12); border-radius:24px; box-shadow:var(--shadow); padding:24px}
    .info-card h2{margin:0 0 8px}
    .info-card p + p{margin-top:.85rem}

  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="nav">
    <div class="container nav-inner">
      <a href="#top" class="brand" aria-label="กลับไปหน้าแรก">
     
          <!-- leaf icon -->
          <img src="assets/images/logo.png" width="32" height="32" alt="โลโก้" style="display:block;" />
  
        <span>ระบบตรวจสอบย้อนกลับผักอุดร</span>
      </a>
      <a class="link" href="#gallery">แกลอรี่</a>
      <div class="spacer"></div>

      <!-- ปุ่มค้นหา (ลิงก์ภายในหน้า) -->
      <a class="btn-outline" href="search.html" aria-label="ค้นหา">ค้นหา</a>

      <!-- เข้าสู่ระบบ ไปไฟล์ login.html -->
      <a class="btn" href="login.html" aria-label="เข้าระบบ">เข้าสู่ระบบ</a>
    </div>
  </nav>

  <!-- HERO -->
  <header id="top" class="hero">
    <div class="container hero-grid">
      <div class="panel">
        <div class="eyebrow">Udon Organic Traceability</div>
        <h1>ระบบการสอบย้อนกลับ ผักอุดร — โปร่งใส ตรวจสอบได้ ปลอดภัย</h1>
        <p>เชื่อมโยงข้อมูลตั้งแต่แปลงปลูกถึงมือคุณ เพื่อความปลอดภัยอาหารและความโปร่งใสในห่วงโซ่อุปทาน</p>
        <div class="hero-cta">
          <a class="btn" href="#gallery">ดูแกลอรี่</a>
        </div>
        <div class="stat">
          <span class="pill">ล็อตสินค้า • แปลงปลูก • ขนส่ง • คุณภาพ</span>
        </div>
      </div>
      <div class="panel" aria-hidden="true" style="display:grid;place-items:center">
	    <iframe title="วิดีโอแนะนำระบบตรวจสอบย้อนกลับ"
        src="https://drive.google.com/file/d/19zz40tSxNyvLYq4BZITIuO7OcsRyO5yY/preview"
        width="100%" height="480" frameborder="0"
        allowfullscreen loading="lazy"
        referrerpolicy="strict-origin-when-cross-origin"
        style="max-width: 100%; border-radius: 12px; display: block;"></iframe>
		
        <!-- Hero image from Google Drive (replaces decorative SVG) 
        <figure class="hero-media" aria-hidden="true">
          <img id="hero-drive-img" src="https://images.unsplash.com/photo-1447175008436-054170c2e979?q=80&w=1600&auto=format&fit=crop" alt="" loading="lazy" />
        </figure>-->
      </div>
    </div>
  </header>

  <!-- INTRO / DESCRIPTION -->
  <section id="intro" aria-labelledby="intro-title">
    <div class="container">
      <article class="info-card">
        <h2 id="intro-title">คำอธิบายระบบ</h2>
        <p>ระบบตรวจสอบย้อนกลับ (Traceability System) คือกระบวนการจัดเก็บและเชื่อมโยงข้อมูลตลอด ห่วงโซ่อุปทาน (Supply Chain) เพื่อระบุแหล่งที่มา การผลิต การขนส่ง และคุณภาพของสินค้า โดยเฉพาะในกลุ่ม สินค้าเกษตรและผักอินทรีย์ (Organic Products) ระบบนี้มีบทบาทสำคัญต่อการสร้างความเชื่อมั่นด้าน ความปลอดภัยอาหาร (Food Safety) และเพิ่ม ความโปร่งใส (Transparency) ในการจัดการสินค้า ทำให้ผู้บริโภคสามารถตรวจสอบได้ว่าอาหารหรือผลิตภัณฑ์ที่ซื้อมีที่มาและมาตรฐานที่เชื่อถือได้</p>
        <p>การใช้ ระบบตรวจสอบย้อนกลับสินค้าเกษตร ยังช่วยยกระดับมาตรฐานการผลิตของเกษตรกร สนับสนุนการส่งออก และตอบโจทย์ตลาดที่ให้ความสำคัญกับคุณภาพ ความปลอดภัย และความยั่งยืน (Sustainability) จึงนับเป็นเครื่องมือสำคัญในการพัฒนาการเกษตรสมัยใหม่</p>
      </article>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" aria-labelledby="gallery-title">
    <div class="container">
      <div class="gallery-card">
        <header class="gallery-toolbar">
          <h2 id="gallery-title">แกลอรี่</h2>
        </header>
        <div class="tab-panel">
          <div id="gallery-status" class="lead" style="padding:12px 4px 6px">กำลังโหลดรูป…</div>
          <div id="skeletons" class="masonry" aria-hidden="true">
            <div class="card-item"><div class="skel"></div></div>
            <div class="card-item"><div class="skel" style="height:280px"></div></div>
            <div class="card-item"><div class="skel" style="height:240px"></div></div>
            <div class="card-item"><div class="skel"></div></div>
            <div class="card-item"><div class="skel" style="height:300px"></div></div>
            <div class="card-item"><div class="skel" style="height:220px"></div></div>
          </div>
          <div id="auto-gallery" class="masonry" role="list" aria-label="แกลอรี่จาก Google Drive" hidden></div>
		  
		 <div id="gallery-pagination" style="text-align:center; margin-top:12px;" hidden>
  <button id="prev-btn" class="chip sm">ก่อนหน้า</button>
  <span id="page-info" style="margin: 0 12px; font-weight:700;"></span>
  <button id="next-btn" class="chip sm">ถัดไป</button>
</div>



        </div>
      </div>
    </div>
  </section>
  <!--div id="lightbox" class="lightbox" aria-hidden="true" hidden>
    <img alt="ภาพขนาดใหญ่จากแกลอรี่" />
    <button class="close" aria-label="ปิดตัวอย่างภาพ">×</button>
  </div-->

  <footer>
    <div class="container foot">
      <div>© <span id="y">2025</span> • ระบบตรวจสอบย้อนกลับผักอุดร</div>
      <nav style="display:flex; gap:12px"><a class="link" href="#gallery">แกลอรี่</a>
      </nav>
    </div>
  </footer>

 <script>
(function(){
  const DRIVE_API_URL = 'https://script.google.com/macros/s/AKfycbxjmo9R8aCdXQP52WSJuqlkTwuv_-cONqvWIhrY_cFSVuFy2OsFO-YTZnzwX27ZKCgZ/exec';
  const DRIVE_FOLDER_ID = '1KD38W2pPXVavJJH0eyIKRn-__bMp07fw';
  const HERO_IMAGE_ID = '';
  const MAX_IMAGES = 13;

  let currentPage = 1;
  let totalPages = 1;
  let files = [];

  const statusEl = document.getElementById('gallery-status');
  const skels = document.getElementById('skeletons');
  const autoGal = document.getElementById('auto-gallery');
  const heroImg = document.getElementById('hero-drive-img');
  const lb = document.getElementById('lightbox');
  const lbImg = lb ? lb.querySelector('img') : null;

  const pagEl = document.getElementById('gallery-pagination');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const pageInfo = document.getElementById('page-info');

  // Lightbox
  function openLightbox(url){
    if (!lb || !lbImg) return;
    lbImg.src = url;
    lb.setAttribute('aria-hidden','false');
    lb.removeAttribute('hidden');
    document.body.style.overflow = 'hidden';
  }
  function closeLightbox(){
    if (!lb || !lbImg) return;
    lb.setAttribute('aria-hidden','true');
    lb.setAttribute('hidden','');
    lbImg.src = '';
    document.body.style.overflow = '';
  }
  if (lb) lb.addEventListener('click', closeLightbox);
  window.addEventListener('keydown', function(e){ if (e.key === 'Escape') closeLightbox(); });

  function toThumb(id, w){ return 'https://drive.google.com/thumbnail?id=' + id + '&sz=' + (w || 'w400'); }
  function toFull(id){ return 'https://drive.google.com/uc?export=view&id=' + id; }

  function buildItem(thumbUrl, fullUrl){
    const wrap = document.createElement('div'); wrap.className = 'card-item';
    const a = document.createElement('a'); a.className = 'thumb'; a.href = fullUrl;
    a.setAttribute('role','button'); a.setAttribute('aria-label','ดูภาพขนาดใหญ่');
    const img = document.createElement('img'); img.loading = 'lazy'; img.src = thumbUrl; img.alt = 'ภาพจากแกลอรี่';
    a.appendChild(img); wrap.appendChild(a); return wrap;
  }

  function setHeroFromFiles(fileList){
    if (!heroImg || !fileList.length) return;
    if (HERO_IMAGE_ID){ heroImg.src = toThumb(HERO_IMAGE_ID, 'w800'); return; }
    const pick = fileList[Math.floor(Math.random() * fileList.length)];
    const url = pick.id ? toThumb(pick.id, 'w800') : pick.thumbnail || pick.view;
    if (url) heroImg.src = url;
  }

  function renderGallery(){
    autoGal.innerHTML = '';
    const start = (currentPage - 1) * MAX_IMAGES;
    const end = start + MAX_IMAGES;
    const filesToShow = files.slice(start, end);
    
    filesToShow.forEach(f => {
      const thumb = f.thumbnail || f.thumbnailLink || toThumb(f.id);
      const full = f.view || toFull(f.id);
      autoGal.appendChild(buildItem(thumb, full));
    });

    pageInfo.textContent = `หน้า ${currentPage} จาก ${totalPages}`;
    prevBtn.disabled = currentPage === 1;
    nextBtn.disabled = currentPage === totalPages;
    pagEl.hidden = totalPages <= 1;
    skels.hidden = true;
    autoGal.hidden = false;
  }

  async function loadDriveGallery(){
    try {
      const res = await fetch(DRIVE_API_URL + '?folder=' + encodeURIComponent(DRIVE_FOLDER_ID), {mode:'cors'});
      if (!res.ok) throw new Error('HTTP ' + res.status);
      const data = await res.json();
      files = (data.files || []).filter(f => (f.mimeType || '').toLowerCase().includes('image/'));

      if (!files.length){
        statusEl.textContent = 'ไม่พบรูปในโฟลเดอร์';
        return;
      }

      totalPages = Math.ceil(files.length / MAX_IMAGES);
      setHeroFromFiles(files);
      statusEl.textContent = `${files.length} รูป (อัปเดตจาก Drive)`;
      renderGallery();

      autoGal.addEventListener('click', function(e){
        const a = e.target.closest('a.thumb');
        if (!a) return;
        e.preventDefault();
        openLightbox(a.href);
      });

    } catch(err){
      console.error(err);
      statusEl.textContent = 'โหลดรูปไม่ได้ — ตรวจสอบ URL ของ Apps Script หรือสิทธิ์การแชร์โฟลเดอร์';
      skels.hidden = true;
      autoGal.hidden = true;
    }
  }

  // Pagination button events
  prevBtn.addEventListener('click', function(){
    if (currentPage > 1){ currentPage--; renderGallery(); }
  });
  nextBtn.addEventListener('click', function(){
    if (currentPage < totalPages){ currentPage++; renderGallery(); }
  });

  document.addEventListener('DOMContentLoaded', loadDriveGallery);
})();
</script>

</body>
</html>
